
# Forced Alignment with Montreal Forced Aligner (MFA)

This repository contains the setup, scripts, and output files for a forced alignment project. The entire pipeline was executed using **Google Colab**.

  * **Acoustic Model:** `english_us_arpa`
  * **Pronunciation Dictionary:** `english_us_arpa`

-----

## How to Reproduce (in Google Colab)

The process is broken into three steps: Environment Setup, Data Preparation, and Running Alignment.

### Step 1: Environment Setup

Run the following code block in a single Colab cell. This will install Miniconda, accept the Terms of Service, create a Conda environment named `aligner`, install MFA, and download the required models.

```bash
# --- 1. Download and Install Miniconda ---
print("Downloading Miniconda...")
!wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
!chmod +x Miniconda3-latest-Linux-x86_64.sh
print("Installing Miniconda...")
!bash ./Miniconda3-latest-Linux-x86_64.sh -b -f -p /usr/local

# --- 2. Add Conda to the System Path ---
import sys
sys.path.append('/usr/local/lib/python3.10/site-packages/')
print("Miniconda path added.")

# --- 3. Accept Anaconda Terms of Service ---
print("Accepting Anaconda Terms of Service...")
!conda config --set anaconda_anon_usage false
!conda tos accept --override-channels --channel https://repo.anaconda.com/pkgs/main
!conda tos accept --override-channels --channel https://repo.anaconda.com/pkgs/r
print("ToS accepted.")

# --- 4. Create Conda Environment and Install MFA ---
print("Creating 'aligner' environment and installing MFA... (This may take 5-10 minutes)")
!conda create -n aligner -c conda-forge montreal-forced-aligner -y
print("MFA environment created.")

# --- 5. Download Required Models ---
print("Downloading 'english_us_arpa' dictionary...")
!source activate aligner && mfa model download dictionary english_us_arpa
print("Downloading 'english_us_arpa' acoustic model...")
!source activate aligner && mfa model download acoustic english_us_arpa
print("Models downloaded.")

# --- 6. Verify Installation ---
print("\n--- Verifying Installation: Installed Models ---")
print("--- Dictionaries: ---")
!source activate aligner && mfa model list dictionary
print("\n--- Acoustic Models: ---")
!source activate aligner && mfa model list acoustic
print("-------------------------------------------------")
print("Setup complete!")

# --- 7. Prepare for Alignment ---
print("\nCreating output directory 'mfa_outputs'...")
!mkdir mfa_outputs
print("Output directory created.")
```

### Step 2: Prepare Dataset

1.  Upload your dataset (`Assignment.zip`) to the Colab session's root directory.

2.  Run this cell to unzip the data:

<!-- end list -->

```bash
!unzip Assignment.zip
```

3.  Run this cell to move all files into the `mfa_dataset` directory for MFA to read:

<!-- end list -->

```bash
!mkdir mfa_dataset

print("Moving files from the correct paths...")

!mv Assignment/wav/*.wav mfa_dataset/
!mv Assignment/transcripts/*.txt mfa_dataset/
!mv Assignment/transcripts/*.TXT mfa_dataset/

print("All files are prepared and ready for alignment!")
```

### Step 3: Run Alignment

Run this final cell to perform the alignment. The results will be saved in the `mfa_outputs` folder.

```bash
!source activate aligner && mfa align mfa_dataset english_us_arpa english_us_arpa mfa_outputs
```

-----

## Project Outputs

This repository contains the final `.TextGrid` files generated by this process (located in the `mfa_outputs` folder in Colab). 
